<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CYC Heritage SMP</title>
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="stylesheet" href="./styles.css">
</head>
<body>

<header style="height: 70px; display: flex; align-items: center; justify-content: space-between; padding: 10px 20px; background-color: #333;">
    <a href="./index.html" style="color: white; text-decoration: none; font-size: 1.5em;">
        üåç CYC Heritage SMP
    </a>
    <div>
        <a href="./index.html" style="
        background-color: #ff0000;
        color: white;
        padding: 8px 16px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: bold;
        transition: background-color 0.3s;
        margin-left: 16px;
        text-align: center;
    " onmouseover="this.style.backgroundColor='#cc0000';" onmouseout="this.style.backgroundColor='#ff0000';">
            Home
        </a>
        <a href="./news.html" style="
        background-color: #ff0000;
        color: white;
        padding: 8px 16px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: bold;
        transition: background-color 0.3s;
        margin-left: 16px;
        text-align: center;
    " onmouseover="this.style.backgroundColor='#cc0000';" onmouseout="this.style.backgroundColor='#ff0000';">
            News
        </a>
        <a href="./teams.html" style="
        background-color: #ff0000;
        color: white;
        padding: 8px 16px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: bold;
        transition: background-color 0.3s;
        margin-left: 16px;
        text-align: center;
    " onmouseover="this.style.backgroundColor='#cc0000';" onmouseout="this.style.backgroundColor='#ff0000';">
            Teams
        </a>
        <a href="./gallery.html" style="
        background-color: #ff0000;
        color: white;
        padding: 8px 16px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: bold;
        transition: background-color 0.3s;
        margin-left: 16px;
        text-align: center;
    " onmouseover="this.style.backgroundColor='#cc0000';" onmouseout="this.style.backgroundColor='#ff0000';">
            Gallery
        </a>
    </div>
</header>

<h1>Want to post an image? Contact me at jackhaney22@gmail.com</h1>

<footer>
    <p style="position: absolute; left: 10px;">&copy; 2025 CYC Heritage SMP</p>
    <a style="margin-right: 10px;" href="https://qc1159.github.io/Quick-Chat/?chatwith=CYCHeritageSMP" target="_blank" class="quickchat-icon" aria-label="Quick Chat Page">
        <img src="QuickChat.svg" alt="YouTube" width="28" height="28">
    </a>
    <a style="margin-right: 10px;" href="https://www.youtube.com/@CYCHeritageSMP" target="_blank" class="youtube-icon" aria-label="YouTube Channel">
        <img src="Youtube.svg" alt="YouTube" width="28" height="28">
    </a>
</footer>

<script>
    document.addEventListener("DOMContentLoaded", async () => {
        const csvUrl = "https://docs.google.com/spreadsheets/d/1M0rXV5xH1FOOn49ha6fBrvpfvQPbtJMvkbVkZ9D4HOQ/export?format=csv&id=1M0rXV5xH1FOOn49ha6fBrvpfvQPbtJMvkbVkZ9D4HOQ&gid=0"; // Replace with your actual CSV URL

        const response = await fetch(csvUrl);
        const text = await response.text();
        const rows = parseCSV(text);

        // Filter out empty rows and reverse for newest first
        const validRows = rows.filter(r => r.some(cell => cell.trim() !== "")).reverse();

        const header = document.querySelector("header");

        validRows.reverse().forEach(([_1, _2, _3, _4, _5, title, image, styledText]) => {
            if (title && image && styledText) {
                const section = document.createElement("section");

                const h2 = document.createElement("h2");
                h2.textContent = title || "Untitled";

                const p1 = document.createElement("img");
                p1.src = image;

                p1.style.width = "100%";
                p1.style.borderRadius = "10px";

                const p2 = document.createElement("p");
                p2.textContent = styledText || "";
                p2.style.color = "#ffcc00"; // Example style
                p2.style.fontStyle = "italic";

                section.appendChild(h2);
                section.appendChild(p1);
                section.appendChild(p2);

                // Insert each section directly after the header, so newer ones stack on top
                header.insertAdjacentElement("afterend", section);
            }
        });


        // Scroll to top section
        //const firstSection = document.querySelector("section");
        //if (firstSection) firstSection.scrollIntoView({ behavior: "smooth" });
    });

    function parseCSV(text) {
        const rows = [];
        const lines = text.trim().split("\n");

        for (const line of lines) {
            const cells = [];
            let current = "";
            let insideQuotes = false;

            for (let i = 0; i < line.length; i++) {
                const char = line[i];

                if (char === '"' && line[i + 1] === '"') {
                    // Escaped quote
                    current += '"';
                    i++;
                } else if (char === '"') {
                    insideQuotes = !insideQuotes;
                } else if (char === ',' && !insideQuotes) {
                    cells.push(current.trim());
                    current = "";
                } else {
                    current += char;
                }
            }

            cells.push(current.trim()); // push last cell
            rows.push(cells);
        }

        return rows;
    }


</script>

</body>
</html>
